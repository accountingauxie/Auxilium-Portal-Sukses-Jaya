<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Invoice Management</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script>
    // Fungsi untuk mengubah status invoice menjadi "approved"
    function approveInvoice(invoiceNumber) {
      const status = "approved";  // Status yang ingin dikirim
      fetch('https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec', {  // Ganti dengan URL Web App Anda
        method: "POST",
        body: JSON.stringify({
          action: "updateStatus",
          invoiceNumber: invoiceNumber,
          status: status
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })
      .then(response => response.json())
      .then(data => {
        if (data.ok) {
          alert("Status berhasil diperbarui.");
        } else {
          alert("Terjadi kesalahan: " + data.error);
        }
      })
      .catch(error => {
        console.error("Error:", error);
        alert("Terjadi kesalahan saat mengirim data.");
      });
    }
  </script>
</head>
<body>

  <h1>Invoice Management</h1>
  
  <!-- Tabel yang berisi daftar invoice -->
  <table border="1">
    <thead>
      <tr>
        <th>Invoice Number</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>INV123456</td>
        <td id="status-INV123456">Pending</td>
        <td><button onclick="approveInvoice('INV123456')">Approve</button></td>
      </tr>
      <tr>
        <td>INV789012</td>
        <td id="status-INV789012">Pending</td>
        <td><button onclick="approveInvoice('INV789012')">Approve</button></td>
      </tr>
    </tbody>
  </table>

</body>
</html>
