<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purchase Order Entry - AUXILIUM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f6f9; /* Abu-abu sangat muda */
            color: #333;
        }

        /* Navbar Styling */
        .navbar {
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            padding: 0.8rem 1.5rem;
        }
        .navbar-brand {
            font-weight: 700;
            font-size: 1.25rem;
            color: #000 !important;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .navbar-brand span {
            font-weight: 300;
            color: #6c757d; /* Warna abu-abu untuk sub-text */
            font-size: 1rem;
        }

        /* Custom Buttons di Navbar */
        .btn-nav-outline {
            border: 1px solid #dee2e6;
            color: #6c757d;
            background: white;
            font-weight: 500;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        .btn-nav-outline:hover {
            background-color: #f8f9fa;
            color: #333;
        }
        
        /* Tombol Aktif (Halaman ini) */
        .btn-nav-active {
            border: 1px solid #007bff;
            color: #007bff;
            background: #f0f8ff;
            font-weight: 600;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .btn-nav-primary {
            background-color: #e0f7fa; /* Cyan muda */
            color: #006064; /* Cyan tua */
            border: none;
            font-weight: 600;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        .btn-nav-primary:hover {
            background-color: #b2ebf2;
            color: #004d40;
        }

        /* Card Form Container */
        .main-card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            background: #ffffff;
            margin-top: 30px;
            padding: 40px;
        }

        .form-label {
            font-weight: 600;
            font-size: 0.9rem;
            color: #495057;
            margin-bottom: 8px;
        }

        .form-select, .form-control {
            border-radius: 8px;
            padding: 10px 12px;
            border: 1px solid #ced4da;
            font-size: 0.95rem;
        }
        .form-select:focus, .form-control:focus {
            box-shadow: 0 0 0 3px rgba(13, 202, 240, 0.15); /* Efek glow cyan saat diklik */
            border-color: #0dcaf0;
        }

        /* Readonly input style */
        .bg-readonly {
            background-color: #f8f9fa;
            color: #6c757d;
        }

        /* Spinner Wrapper */
        #loader {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: #6c757d;
        }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                AUXILIUM <span>Accounting Management Service</span>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-end" id="navbarContent">
                <div class="d-flex gap-2">
                    <a href="https://accountingauxie.github.io/Auxilium-Portal-Sukses-Jaya/receiving/index.html" class="btn btn-nav-outline rounded-3 text-decoration-none">
                        <i class="bi bi-arrow-left"></i> Home Receiving
                    </a>

                    <a href="https://script.google.com/macros/s/AKfycbzDM8D94zg1tp5XXVoMY6ap1zwEKoalzNr_c7KtRK134YP6elaESXbR4d6IF1P_Mt-XrA/exec" class="btn btn-nav-active rounded-3 text-decoration-none">
                        <i class="bi bi-file-earmark-plus"></i> PO Entry
                    </a>

                    <a href="https://accountingauxie.github.io/Auxilium-Portal-Sukses-Jaya/receiving/ImportXeroPO/index.html" class="btn btn-nav-primary rounded-3 text-decoration-none">
                        <i class="bi bi-cloud-upload"></i> Import Xero PO
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container" style="margin-top: 100px; max-width: 900px;">
        
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h3 class="fw-bold m-0">Buat Purchase Order</h3>
            <div id="loader">
                <div class="spinner-border spinner-border-sm text-primary" role="status"></div>
                <span>Memuat data vendor...</span>
            </div>
        </div>

        <div class="main-card">
            <div class="row g-4">
                
                <div class="col-12">
                    <label for="vendorSelect" class="form-label">Pilih Vendor</label>
                    <select class="form-select" id="vendorSelect" onchange="onVendorChange()">
                        <option value="" disabled selected>Menunggu data...</option>
                    </select>
                </div>

                <div class="col-12">
                    <label for="itemSelect" class="form-label">Pilih Item</label>
                    <select class="form-select" id="itemSelect" disabled onchange="onItemChange()">
                        <option value="">-- Pilih Vendor Terlebih Dahulu --</option>
                    </select>
                </div>

                <div class="col-md-6">
                    <label for="unitInput" class="form-label">Satuan</label>
                    <input type="text" class="form-control bg-readonly" id="unitInput" readonly placeholder="-">
                </div>

                <div class="col-md-6">
                    <label for="qtyInput" class="form-label">Jumlah Order</label>
                    <input type="number" class="form-control" id="qtyInput" placeholder="0">
                </div>
                
                <div class="col-12 text-end mt-4">
                     <button class="btn btn-secondary me-2" onclick="location.reload()">Reset</button>
                     <button class="btn btn-primary px-4" style="background-color: #007bff;">Tambahkan Item</button>
                </div>
            </div>
        </div>

        <div class="mt-5 mb-5">
            <h5 class="fw-bold mb-3">Daftar Item PO</h5>
            <div class="card border-0 shadow-sm rounded-3">
                <div class="card-body p-0">
                    <table class="table table-hover mb-0">
                        <thead class="table-light">
                            <tr>
                                <th class="ps-4">No</th>
                                <th>Item</th>
                                <th>Vendor</th>
                                <th>Qty</th>
                                <th>Satuan</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="6" class="text-center py-4 text-muted">Belum ada item yang ditambahkan</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>

    <script>
      var allData = {};

      window.onload = function() {
        google.script.run.withSuccessHandler(populateVendors).getDataFromSheet();
      };

      function populateVendors(data) {
        allData = data;
        var vendorSelect = document.getElementById("vendorSelect");
        var loader = document.getElementById("loader");

        loader.style.display = 'none';
        
        vendorSelect.innerHTML = '<option value="" disabled selected>-- Pilih Vendor --</option>';

        var vendors = Object.keys(allData).sort();
        vendors.forEach(function(vendorName) {
          var option = document.createElement("option");
          option.text = vendorName;
          option.value = vendorName;
          vendorSelect.add(option);
        });
      }

      function onVendorChange() {
        var selectedVendor = document.getElementById("vendorSelect").value;
        var itemSelect = document.getElementById("itemSelect");
        var unitInput = document.getElementById("unitInput");

        itemSelect.disabled = false;
        itemSelect.innerHTML = '<option value="" disabled selected>-- Pilih Item --</option>';
        unitInput.value = "";

        var items = allData[selectedVendor];

        if (items) {
          items.forEach(function(obj, index) {
            var option = document.createElement("option");
            option.text = obj.item;
            option.value = index; 
            itemSelect.add(option);
          });
        }
      }

      function onItemChange() {
        var selectedVendor = document.getElementById("vendorSelect").value;
        var selectedItemIndex = document.getElementById("itemSelect").value;
        
        var itemData = allData[selectedVendor][selectedItemIndex];
        document.getElementById("unitInput").value = itemData.unit;
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
