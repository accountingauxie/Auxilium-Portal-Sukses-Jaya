<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Login – AUXILIUM Portal</title>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; font-family: Inter, sans-serif; }

body {
  background: #ffffff;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  position: relative;
}

#bg-canvas { position: fixed; inset: 0; z-index: 0; }
.overlay { position: fixed; inset: 0; background: rgba(255,255,255,0.75); z-index: 1; }

.card {
  width: 360px;
  padding: 28px;
  background: #ffffffcc;
  border-radius: 16px;
  backdrop-filter: blur(12px);
  box-shadow: 0 6px 22px rgba(0,0,0,0.12);
  z-index: 3;
}

.card img { width: 210px; margin: 0 auto 10px; display: block; }
h2 { text-align: center; margin-bottom: 6px; font-size: 22px; }
p { text-align: center; color: #666; font-size: 13px; margin-bottom: 20px; }

label { font-size: 13px; margin-bottom: 4px; display: block; }
input {
  width: 100%; padding: 10px; margin-bottom: 14px;
  border: 1px solid #ddd; border-radius: 8px; font-size: 14px;
}

button {
  width: 100%; padding: 11px; background: #2563eb;
  color: white; border: none; border-radius: 999px; font-size: 14px;
  cursor: pointer;
}

.msg {
  font-size: 13px;
  margin-bottom: 10px;
  padding: 8px;
  border-radius: 8px;
  display: none;
}
.error { background: #fee2e2; color: #b91c1c; }
.success { background: #dcfce7; color: #166534; }

/* ===================== ULTRA PREMIUM LOADER ===================== */
.auxie-loader {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at center,
    rgba(255,255,255,1) 0%,
    rgba(245,245,255,0.95) 40%,
    rgba(235,240,255,0.92) 100%);
  display: flex;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(12px);
  z-index: 99999;
  transition: opacity .55s ease;
}
.auxie-loader.hide {
  opacity: 0;
  pointer-events: none;
}

.rings {
  position: relative;
  width: 160px;
  height: 160px;
}

.ring {
  position: absolute;
  border-radius: 50%;
  border-style: solid;
  border-width: 6px;
  filter:
    drop-shadow(0 0 8px rgba(0,255,255,0.45))
    drop-shadow(0 0 16px rgba(220,0,255,0.35))
    drop-shadow(0 0 28px rgba(150,70,255,0.3));
}

.ring-lg {
  width: 160px;
  height: 160px;
  border-color: rgba(0,180,255,1) transparent transparent transparent;
  animation: spinCW 2.6s linear infinite;
}

.ring-md {
  width: 115px;
  height: 115px;
  top: 22px; left: 22px;
  border-color: rgba(210,90,255,0.95) transparent transparent transparent;
  animation: spinCCW 1.8s linear infinite;
}

.ring-sm {
  width: 70px;
  height: 70px;
  top: 45px; left: 45px;
  border-color: rgba(255,70,140,1) transparent transparent transparent;
  animation: spinCWfast 1.2s linear infinite;
}

@keyframes spinCW { to { transform: rotate(360deg); } }
@keyframes spinCCW { to { transform: rotate(-360deg); } }
@keyframes spinCWfast { to { transform: rotate(540deg); } }

</style>
</head>

<body>

<!-- BACKGROUND -->
<canvas id="bg-canvas"></canvas>
<div class="overlay"></div>

<!-- ULTRA PREMIUM LOADER -->
<div id="auxieLoading" class="auxie-loader">
  <div class="rings">
    <div class="ring ring-lg"></div>
    <div class="ring ring-md"></div>
    <div class="ring ring-sm"></div>
  </div>
</div>

<!-- CARD -->
<div class="card">
  <img src="assets/auxilium_logo_pure_white_bg.png" alt="Logo">
  <h2>Masuk</h2>
  <p>AUXILIUM Portal – CV. Sukses Jaya</p>

  <div id="msg" class="msg"></div>

  <label>Email</label>
  <input id="email" type="email">

  <label>Password</label>
  <input id="password" type="password">

  <button onclick="login()">Login</button>

  <p style="margin-top:12px;">
    Belum punya akun? <a href="register.html">Daftar</a>
  </p>
</div>

<script>
// ================= CONFIG =================
const API = "https://script.google.com/macros/s/AKfycbyoaUOABCo4H2LVn4ufnvHWznko2rNrkHPKQaIZiPg0o8ipuxxtGLysxZdRJGVhHQAOmw/exec";

const loader = document.getElementById("auxieLoading");

function showMessage(text, type) {
  const msg = document.getElementById("msg");
  msg.textContent = text;
  msg.className = "msg " + type;
  msg.style.display = "block";
}

// AUTO HIDE LOADER ON PAGE LOAD
window.addEventListener("load", () => {
  setTimeout(() => loader.classList.add("hide"), 350);
});

// ================= LOGIN =================
async function login() {
  loader.classList.remove("hide"); // show loader

  const u = email.value.trim();
  const p = password.value.trim();

  if (!u || !p) {
    loader.classList.add("hide");
    showMessage("Email dan password wajib diisi.", "error");
    return;
  }

  try {
    const url = `${API}?action=login&email=${encodeURIComponent(u)}&password=${encodeURIComponent(p)}`;
    const res = await fetch(url);
    const json = await res.json();

    loader.classList.add("hide"); // hide loader

    if (!json.ok) {
      showMessage(json.error || "Login gagal.", "error");
      return;
    }

    localStorage.setItem("uxilium_current_user", JSON.stringify(json.data));

    showMessage("Login berhasil!", "success");

    setTimeout(() => {
      if (json.data.role === "admin") window.location.href = "admin.html";
      else window.location.href = "index.html";
    }, 700);

  } catch (err) {
    loader.classList.add("hide");
    console.error(err);
    showMessage("Terjadi kesalahan koneksi ke server.", "error");
  }
}

// ================= BACKGROUND ANIMATION =================
const canvas = document.getElementById("bg-canvas");
const ctx = canvas.getContext("2d");
let W, H;

function resize() {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}
resize();
window.onresize = resize;

const dots = [];
for (let i = 0; i < 45; i++) {
  dots.push({
    x: Math.random() * W,
    y: Math.random() * H,
    r: 4 + Math.random() * 10,
    dx: (Math.random() - 0.5) * 0.7,
    dy: (Math.random() - 0.5) * 0.7
  });
}

let mouse = { x: null, y: null };
window.onmousemove = e => (mouse = { x: e.x, y: e.y });
window.onmouseleave = () => (mouse = { x: null, y: null });

function animate() {
  ctx.clearRect(0, 0, W, H);
  ctx.fillStyle = "#fff";
  ctx.fillRect(0, 0, W, H);

  dots.forEach(d => {
    d.x += d.dx;
    d.y += d.dy;

    if (d.x < 0 || d.x > W || d.y < 0 || d.y > H) {
      d.x = Math.random() * W;
      d.y = Math.random() * H;
    }

    if (mouse.x != null) {
      const dx = d.x - mouse.x;
      const dy = d.y - mouse.y;
      const dist = Math.sqrt(dx * dx + dy * dy);

      if (dist < 150) {
        d.x += (dx / dist) * 2;
        d.y += (dy / dist) * 2;
      }
    }

    ctx.beginPath();
    ctx.arc(d.x, d.y, d.r, 0, Math.PI * 2);
    ctx.fillStyle = "rgba(120,150,255,0.5)";
    ctx.fill();
  });

  requestAnimationFrame(animate);
}
animate();
</script>

</body>
</html>
